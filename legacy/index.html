<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live DAW</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="daw-container">
        <!-- Top Transport & DAW Info Bar -->
        <div class="transport-bar">
            <div class="daw-info">
                <div class="time-display">
                    <div class="label">TIME</div>
                    <div id="time-display" class="value">01:01:0.0</div>
                </div>
                <div class="bpm-display">
                    <div class="label">BPM</div>
                    <input id="bpm-input" type="number" min="20" max="300" value="120" class="bpm-input">
                </div>
                <div class="loop-inafo">
                    <div class="label">LOOP</div>
                    <div id="loop-display" class="value">4 bars</div>
                </div>
            </div>

            <!-- Transport Buttons -->
            <div class="transport-controls">
                <button id="play-btn" class="transport-btn play-btn" title="Play">▶</button>
                <button id="stop-btn" class="transport-btn stop-btn" title="Stop">■</button>
                <button id="record-btn" class="transport-btn record-btn" title="Record">⦿</button>
                <button id="metronome-btn" class="transport-btn metronome-btn" title="Metronome">♩</button>
                <div id="recording-indicator" class="recording-indicator"></div>
            </div>

            <!-- View Toggle -->
            <div class="view-toggle">
                <button id="view-instrument-btn" class="view-btn view-btn-active" title="Instrument View">INST</button>
                <button id="view-piano-roll-btn" class="view-btn" title="Piano Roll View">ROLL</button>
            </div>

            <!-- Octave Controls -->
            <div class="octave-controls">
                <button id="octave-down-btn" class="octave-btn">-OCT</button>
                <div id="octave-display" class="octave-value">C4</div>
                <button id="octave-up-btn" class="octave-btn">+OCT</button>
                <button id="keyboard-help-btn" class="keyboard-help-btn" title="Keyboard Help">⌨</button>
            </div>
        </div>

        <!-- Main DAW Layout -->
        <div class="daw-layout">
            <!-- Left Sidebar: Oscilloscope + Info -->
            <div class="left-sidebar">
                <!-- Oscilloscope Module -->
                <div class="module oscilloscope-module">
                    <div class="module-header">
                        <span class="module-title">WAVEFORM</span>
                        <button id="oscilloscope-mode-toggle" class="oscilloscope-toggle-btn" title="Toggle visualization mode">
                            <span class="toggle-icon">W</span>
                        </button>
                    </div>
                    <div class="oscilloscope-container">
                        <canvas id="oscilloscope"></canvas>
                    </div>
                </div>

                <!-- Keyboard Info -->
                <div class="module keyboard-info-module">
                    <div class="module-header">
                        <span class="module-title">INFO</span>
                    </div>
                    <div class="module-content">
                        <p class="info-label">A-K Keys (Piano)</p>
                        <p class="active-notes">Notes: <span id="active-notes-count">0</span></p>
                    </div>
                </div>
            </div>

            <!-- Right Side: Control Modules in 5-Column Grid -->
            <div class="controls-area">
                <!-- Modules will be dynamically added here by the module system -->
            </div>
        </div>

        <!-- Piano Roll View (Hidden by default) -->
        <div id="piano-roll-view" class="piano-roll-view" style="display: none;">
            <div class="piano-roll-container">
                <!-- Left: Piano Keys -->
                <div class="piano-keys-sidebar">
                    <div class="piano-keys-header">NOTES</div>
                    <div class="piano-keys-list" id="piano-keys-list">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Right: Piano Roll Grid -->
                <div class="piano-roll-area">
                    <div class="piano-roll-header">
                        <div class="time-ruler" id="time-ruler">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                    <div class="piano-roll-grid-container">
                        <div class="piano-roll-grid" id="piano-roll-grid">
                            <!-- Will be populated by JavaScript -->
                        </div>
                        <div class="playback-line" id="playback-line" style="left: 0%;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- V2 Low-Latency Engines -->
    <script src="audio-engine-v2.js"></script>
    <script src="oscilloscope-v2.js"></script>
    
    <!-- New Transport & Recording System -->
    <script src="transport.js"></script>
    <script src="midi-recorder.js"></script>
    <script src="playback-scheduler.js"></script>
    
    <!-- MIDI Device Support -->
    <script src="midi-device-handler.js"></script>
    
    <!-- Onboarding -->
    <script src="onboarding.js"></script>
    
    <!-- Core DAW Scripts -->
    <script src="daw-core.js"></script>
    <script src="keyboard-controller.js"></script>
    <script src="keyboard-help.js"></script>
    <script src="module-system.js"></script>
    <script src="module-layout.js"></script>
    <script src="module-ui.js"></script>
    <script src="knob.js"></script>
    <script src="piano-roll.js"></script>
    
    <!-- V2 Integration -->
    <script src="app-v2-integration.js"></script>
    
    <!-- Legacy engines (commented out, kept for reference) -->
    <!--
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <script src="audio-engine.js"></script>
    <script src="oscilloscope.js"></script>
    <script src="app.js"></script>
    -->
</body>
</html>
